{"ast":null,"code":"var _jsxFileName = \"/Users/robinmarillia/Documents/dev/homeView/src/index.js\";\nimport React, { Component } from \"react\";\nimport ReactDOM from \"react-dom\";\nimport * as THREE from \"three\";\nimport { WEBVR } from 'three/examples/jsm/vr/WebVR.js';\nimport \"./index.css\";\nimport rooms from \"./json/rooms.json\";\n\nclass ItemRoom extends Component {\n  render() {\n    //var filename = process.env.PUBLIC_URL + '/img/' + {this.props.filename};\n    return React.createElement(\"div\", {\n      className: \"ItemNav\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 15\n      },\n      __self: this\n    }, this.props.name);\n  }\n\n}\n\nclass SelectRoom extends Component {\n  render() {\n    // on va remplir un tableau d'élément jsx\n    var roomsRender = []; // on scan chaque élément du json\n\n    rooms.forEach(element => {\n      var filename = element.filename;\n      var filenameArray = filename.split(\"-\");\n      var date = filenameArray[filenameArray.length - 1];\n      var name = element.name;\n      roomsRender.push(React.createElement(\"div\", {\n        onClick: () => this.props.action(filename),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 35\n        },\n        __self: this\n      }, React.createElement(ItemRoom, {\n        filename: filename,\n        name: name,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 35\n        },\n        __self: this\n      })));\n    });\n    return React.createElement(\"nav\", {\n      className: \"SelectNav\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 40\n      },\n      __self: this\n    }, roomsRender);\n  }\n\n}\n\nclass FrameVR extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      room: this.props.room\n    };\n  }\n\n  componentDidMount() {\n    //this.setState({ renderer: WEBVR.createButton( renderer, { referenceSpaceType: 'local' } ) });\n    // on ajoute l'élément au composant react\n    var camera, scene, renderer;\n    var isUserInteracting = false,\n        onMouseDownMouseX = 0,\n        onMouseDownMouseY = 0,\n        lon = 0,\n        onMouseDownLon = 0,\n        lat = 0,\n        onMouseDownLat = 0,\n        phi = 0,\n        theta = 0; // on récupère la room\n\n    var room = this.state.room;\n    alert(room); // on active le frame\n\n    var frame = init(room);\n    this.mount.appendChild(frame);\n    animate();\n\n    function init(room) {\n      var mesh;\n      camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 1, 1100);\n      camera.target = new THREE.Vector3(0, 0, 0);\n      scene = new THREE.Scene();\n      var geometry = new THREE.SphereBufferGeometry(500, 60, 40); // invert the geometry on the x-axis so that all of the faces point inward\n\n      geometry.scale(-1, 1, 1);\n      var texture = new THREE.TextureLoader().load(process.env.PUBLIC_URL + '/img/' + room);\n      var material = new THREE.MeshBasicMaterial({\n        map: texture\n      });\n      mesh = new THREE.Mesh(geometry, material);\n      scene.add(mesh);\n      renderer = new THREE.WebGLRenderer();\n      renderer.setPixelRatio(window.devicePixelRatio);\n      renderer.setSize(window.innerWidth, window.innerHeight);\n      document.addEventListener('mousedown', onPointerStart, false);\n      document.addEventListener('mousemove', onPointerMove, false);\n      document.addEventListener('mouseup', onPointerUp, false);\n      document.addEventListener('wheel', onDocumentMouseWheel, false);\n      document.addEventListener('touchstart', onPointerStart, false);\n      document.addEventListener('touchmove', onPointerMove, false);\n      document.addEventListener('touchend', onPointerUp, false);\n      document.addEventListener('dragover', function (event) {\n        event.preventDefault();\n        event.dataTransfer.dropEffect = 'copy';\n      }, false);\n      document.addEventListener('dragenter', function () {\n        document.body.style.opacity = 0.5;\n      }, false);\n      document.addEventListener('dragleave', function () {\n        document.body.style.opacity = 1;\n      }, false);\n      document.addEventListener('drop', function (event) {\n        event.preventDefault();\n        var reader = new FileReader();\n        reader.addEventListener('load', function (event) {\n          material.map.image.src = event.target.result;\n          material.map.needsUpdate = true;\n        }, false);\n        reader.readAsDataURL(event.dataTransfer.files[0]);\n        document.body.style.opacity = 1;\n      }, false); //\n\n      window.addEventListener('resize', onWindowResize, false);\n      return renderer.domElement;\n    }\n\n    function onWindowResize() {\n      camera.aspect = window.innerWidth / window.innerHeight;\n      camera.updateProjectionMatrix();\n      renderer.setSize(window.innerWidth, window.innerHeight);\n    }\n\n    function onPointerStart(event) {\n      isUserInteracting = true;\n      var clientX = event.clientX || event.touches[0].clientX;\n      var clientY = event.clientY || event.touches[0].clientY;\n      onMouseDownMouseX = clientX;\n      onMouseDownMouseY = clientY;\n      onMouseDownLon = lon;\n      onMouseDownLat = lat;\n    }\n\n    function onPointerMove(event) {\n      if (isUserInteracting === true) {\n        var clientX = event.clientX || event.touches[0].clientX;\n        var clientY = event.clientY || event.touches[0].clientY;\n        lon = (onMouseDownMouseX - clientX) * 0.1 + onMouseDownLon;\n        lat = (clientY - onMouseDownMouseY) * 0.1 + onMouseDownLat;\n      }\n    }\n\n    function onPointerUp() {\n      isUserInteracting = false;\n    }\n\n    function onDocumentMouseWheel(event) {\n      var fov = camera.fov + event.deltaY * 0.05;\n      camera.fov = THREE.Math.clamp(fov, 10, 75);\n      camera.updateProjectionMatrix();\n    }\n\n    function animate() {\n      requestAnimationFrame(animate);\n      update();\n    }\n\n    function update() {\n      lat = Math.max(-85, Math.min(85, lat));\n      phi = THREE.Math.degToRad(90 - lat);\n      theta = THREE.Math.degToRad(lon);\n      camera.target.x = 500 * Math.sin(phi) * Math.cos(theta);\n      camera.target.y = 500 * Math.cos(phi);\n      camera.target.z = 500 * Math.sin(phi) * Math.sin(theta);\n      camera.lookAt(camera.target);\n      /*\n      // distortion\n      camera.position.copy( camera.target ).negate();\n      */\n\n      renderer.render(scene, camera);\n    }\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 245\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      ref: ref => this.mount = ref,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 246\n      },\n      __self: this\n    }));\n  }\n\n}\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      frameVRSize: \"small\",\n      room: \"room4-salon-291019.JPG\"\n    };\n    /*\n     Bind our childHandler function to this context\n     that will get called from our Child component\n    */\n\n    this.childHandler = this.childHandler.bind(this);\n  } // on récupère la room depuis le menu\n\n\n  childHandler(dataFromChild) {\n    this.setState({\n      room: dataFromChild\n    });\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 279\n      },\n      __self: this\n    }, React.createElement(SelectRoom, {\n      action: this.childHandler,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 280\n      },\n      __self: this\n    }), React.createElement(FrameVR, {\n      size: this.state.frameVRSize,\n      room: this.state.room,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 281\n      },\n      __self: this\n    }));\n  }\n\n}\n\nconst rootElement = document.getElementById(\"root\");\nReactDOM.render(React.createElement(App, {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 288\n  },\n  __self: this\n}), rootElement);","map":{"version":3,"sources":["/Users/robinmarillia/Documents/dev/homeView/src/index.js"],"names":["React","Component","ReactDOM","THREE","WEBVR","rooms","ItemRoom","render","props","name","SelectRoom","roomsRender","forEach","element","filename","filenameArray","split","date","length","push","action","FrameVR","constructor","state","room","componentDidMount","camera","scene","renderer","isUserInteracting","onMouseDownMouseX","onMouseDownMouseY","lon","onMouseDownLon","lat","onMouseDownLat","phi","theta","alert","frame","init","mount","appendChild","animate","mesh","PerspectiveCamera","window","innerWidth","innerHeight","target","Vector3","Scene","geometry","SphereBufferGeometry","scale","texture","TextureLoader","load","process","env","PUBLIC_URL","material","MeshBasicMaterial","map","Mesh","add","WebGLRenderer","setPixelRatio","devicePixelRatio","setSize","document","addEventListener","onPointerStart","onPointerMove","onPointerUp","onDocumentMouseWheel","event","preventDefault","dataTransfer","dropEffect","body","style","opacity","reader","FileReader","image","src","result","needsUpdate","readAsDataURL","files","onWindowResize","domElement","aspect","updateProjectionMatrix","clientX","touches","clientY","fov","deltaY","Math","clamp","requestAnimationFrame","update","max","min","degToRad","x","sin","cos","y","z","lookAt","ref","App","frameVRSize","childHandler","bind","dataFromChild","setState","rootElement","getElementById"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport ReactDOM from \"react-dom\";\nimport * as THREE from \"three\";\nimport { WEBVR } from 'three/examples/jsm/vr/WebVR.js';\nimport \"./index.css\";\nimport rooms from \"./json/rooms.json\";\n\nclass ItemRoom extends Component {\n\n\n\n  render(){\n    //var filename = process.env.PUBLIC_URL + '/img/' + {this.props.filename};\n    return (\n      <div className=\"ItemNav\" >{this.props.name}</div>\n    )\n  }\n}\nclass SelectRoom extends Component {\n\n  render() {\n\n    // on va remplir un tableau d'élément jsx\n    var roomsRender = [];\n    // on scan chaque élément du json\n    rooms.forEach((element) => {\n\n      var filename = element.filename;\n\n      var filenameArray = filename.split(\"-\");\n      var date = filenameArray[filenameArray.length-1];\n\n      var name = element.name;\n\n      roomsRender.push(<div onClick={()=>this.props.action(filename)}><ItemRoom filename={filename} name={name}/></div>);\n\n    });\n\n    return (\n      <nav className=\"SelectNav\">\n\n          {roomsRender}\n\n      </nav>\n    )\n  }\n}\nclass FrameVR extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n       room: this.props.room\n       };\n  }\n  componentDidMount() {\n\n    //this.setState({ renderer: WEBVR.createButton( renderer, { referenceSpaceType: 'local' } ) });\n    // on ajoute l'élément au composant react\n\n    var camera, scene, renderer;\n\n\t\tvar isUserInteracting = false,\n\t\t\t\tonMouseDownMouseX = 0, onMouseDownMouseY = 0,\n\t\t\t\tlon = 0, onMouseDownLon = 0,\n\t\t\t\tlat = 0, onMouseDownLat = 0,\n\t\t\t\tphi = 0, theta = 0;\n\n    // on récupère la room\n    var room = this.state.room;\n    alert(room);\n    // on active le frame\n    var frame = init(room);\n\n    this.mount.appendChild( frame );\n\t\tanimate();\n\n\n\n\n    function init(room) {\n\n        var mesh;\n\n\n        camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 1, 1100 );\n        camera.target = new THREE.Vector3( 0, 0, 0 );\n\n        scene = new THREE.Scene();\n\n        var geometry = new THREE.SphereBufferGeometry( 500, 60, 40 );\n        // invert the geometry on the x-axis so that all of the faces point inward\n        geometry.scale( -1, 1, 1 );\n\n        var texture = new THREE.TextureLoader().load( process.env.PUBLIC_URL + '/img/'+room );\n\n        var material = new THREE.MeshBasicMaterial( { map: texture } );\n\n        mesh = new THREE.Mesh( geometry, material );\n\n        scene.add( mesh );\n\n        renderer = new THREE.WebGLRenderer();\n        renderer.setPixelRatio( window.devicePixelRatio );\n        renderer.setSize( window.innerWidth, window.innerHeight );\n\n        document.addEventListener( 'mousedown', onPointerStart, false );\n        document.addEventListener( 'mousemove', onPointerMove, false );\n        document.addEventListener( 'mouseup', onPointerUp, false );\n\n        document.addEventListener( 'wheel', onDocumentMouseWheel, false );\n\n        document.addEventListener( 'touchstart', onPointerStart, false );\n        document.addEventListener( 'touchmove', onPointerMove, false );\n        document.addEventListener( 'touchend', onPointerUp, false );\n\n\n        document.addEventListener( 'dragover', function ( event ) {\n\n          event.preventDefault();\n          event.dataTransfer.dropEffect = 'copy';\n\n        }, false );\n\n        document.addEventListener( 'dragenter', function () {\n\n          document.body.style.opacity = 0.5;\n\n        }, false );\n\n        document.addEventListener( 'dragleave', function () {\n\n          document.body.style.opacity = 1;\n\n        }, false );\n\n        document.addEventListener( 'drop', function ( event ) {\n\n          event.preventDefault();\n\n          var reader = new FileReader();\n          reader.addEventListener( 'load', function ( event ) {\n\n            material.map.image.src = event.target.result;\n            material.map.needsUpdate = true;\n\n          }, false );\n          reader.readAsDataURL( event.dataTransfer.files[ 0 ] );\n\n          document.body.style.opacity = 1;\n\n        }, false );\n\n        //\n\n        window.addEventListener( 'resize', onWindowResize, false );\n\n        return(renderer.domElement);\n      }\n\n\n    function onWindowResize() {\n\n        camera.aspect = window.innerWidth / window.innerHeight;\n        camera.updateProjectionMatrix();\n\n        renderer.setSize( window.innerWidth, window.innerHeight );\n\n      }\n\n    function onPointerStart( event ) {\n        isUserInteracting = true;\n\n        var clientX = event.clientX || event.touches[ 0 ].clientX;\n        var clientY = event.clientY || event.touches[ 0 ].clientY;\n\n        onMouseDownMouseX = clientX;\n        onMouseDownMouseY = clientY;\n\n        onMouseDownLon = lon;\n        onMouseDownLat = lat;\n\n      }\n\n    function onPointerMove( event ) {\n        if ( isUserInteracting === true ) {\n\n          var clientX = event.clientX || event.touches[ 0 ].clientX;\n          var clientY = event.clientY || event.touches[ 0 ].clientY;\n\n          lon = ( onMouseDownMouseX - clientX ) * 0.1 + onMouseDownLon;\n          lat = ( clientY - onMouseDownMouseY ) * 0.1 + onMouseDownLat;\n\n        }\n\n      }\n\n    function onPointerUp() {\n\n        isUserInteracting = false;\n\n      }\n\n    function onDocumentMouseWheel( event ) {\n        var fov = camera.fov + event.deltaY * 0.05;\n\n        camera.fov = THREE.Math.clamp( fov, 10, 75 );\n\n        camera.updateProjectionMatrix();\n\n      }\n\n    function animate() {\n\n        requestAnimationFrame( animate );\n        update();\n\n      }\n\n    function update() {\n\n        lat = Math.max( - 85, Math.min( 85, lat ) );\n        phi = THREE.Math.degToRad( 90 - lat );\n        theta = THREE.Math.degToRad( lon );\n\n        camera.target.x = 500 * Math.sin( phi ) * Math.cos( theta );\n        camera.target.y = 500 * Math.cos( phi );\n        camera.target.z = 500 * Math.sin( phi ) * Math.sin( theta );\n\n        camera.lookAt( camera.target );\n\n        /*\n        // distortion\n        camera.position.copy( camera.target ).negate();\n        */\n\n        renderer.render( scene, camera );\n\n      }\n\n  }\n\n\n  render() {\n    return (\n      <div>\n        <div ref={ref => (this.mount = ref)} />\n\n      </div>\n    )\n  }\n}\nclass App extends Component {\n  constructor(props) {\n      super(props)\n      this.state = {\n          frameVRSize: \"small\",\n          room: \"room4-salon-291019.JPG\"\n      };\n\n      /*\n       Bind our childHandler function to this context\n       that will get called from our Child component\n      */\n      this.childHandler = this.childHandler.bind(this)\n  }\n\n  // on récupère la room depuis le menu\n  childHandler(dataFromChild) {\n\n        this.setState({\n            room: dataFromChild\n        });\n    }\n\n  render() {\n\n\n    return (\n      <div>\n        <SelectRoom action={this.childHandler}/>\n        <FrameVR size={this.state.frameVRSize} room={this.state.room}/>\n      </div>\n    )\n  }\n}\n\nconst rootElement = document.getElementById(\"root\");\nReactDOM.render(<App />, rootElement);\n"]},"metadata":{},"sourceType":"module"}